---
layout: post
title: "hekad安装部署文档"
comments: true
---

    # 安装
    以下安装文档基于CentOS。
    ## 源码编译安装
      # 解决依赖：安装`go >= 1.4`, `CMake >= 3.0.0`, `glibc-devel`, `patch`;
      # 下载源码：`git clone https://github.com/mozilla-services/heka`;
      # 进入heka源码目录，创建`build`文件夹，运行`build.sh`， `build.sh` 会检查依赖，并生成`makefile`；
      # `build.sh`会自动进入`build`文件夹，在该文件夹下运行`make && make install`，成功之后hekad会被安装在/usr/bin中;
    ## rpm安装
      # 从https://github.com/mozilla-services/heka/releases 下载对应版本的rpm包。
      # `rpm -ivh heka-version.rpm`， hekad会被安装在/usr/bin中；

    # 配置
    部署heka的主要工作是创建`hekad`的配置文件(`.toml`).
    ## heka日志处理流程
          hekad input 组件接收日志 => hekad splitter 组件和 decoder 组件对日志进行初步处理，将日志转换成heka的message => hekad encoder组件处理message => hekad output 组件 将encoder处理之后的message输出。
    ## heka配置详情
      # `[hekad]` 这个session指定hekad的全局配置，详情请见[hekad全局配置](http://hekad.readthedocs.io/en/v0.10.0/config/index.html#global-configuration-options);
      # `[input]` 指定日志输入源，每个`[input]`session可以

    # 启动

    运行`hekad`即可启动heka的日志收集服务。`hekad`运行的时候需要指定`config`文件，默认是`/etc/hekad.toml`。如果在别的地方创建了配置文件，可以通过`-config`参数指定。
